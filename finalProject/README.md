<p align="center">
  <img src="https://www.uit.edu.vn/sites/vi/files/banner_uit_0.png" title="avatar_UIT">
</p>

<h1 align="center">
    
  **BÃO CÃO Äá»’ ÃN CUá»I Ká»²**
  
  **PHÃT HIá»†N Má»˜T Sá» Bá»†NH TRÃŠN LÃ CÃ‚Y CÃ€ PHÃŠ**

</h1>

* **GiÃ¡o viÃªn hÆ°á»›ng Dáº«n** :

| STT | Há» tÃªn | Email |
| :---: | --- | --- |
| 1 | **PGS.TS. LÃª ÄÃ¬nh Duy** | *duyld@uit.edu.vn* |
| 2 | **Ths. Pháº¡m Nguyá»…n TrÆ°á»ng An** | *truonganpn@uit.edu.vn* |

* **Giá»›i thiá»‡u thÃ nh viÃªn nhÃ³m**
<!-- ### ThÃ´ng tin liÃªn há»‡ -->
| STT | MSSV | Há» tÃªn | Gmail |
|:--- | :-------|:----------|:------------|
|1|19521322|Huá»³nh Ngá»c CÃ´ng Danh|19521322@gm.uit.edu.vn|
|2|19522524|Nguyá»…n PhÃº Vinh| 19522524@gm.uit.edu.vn|
|3|19521858|VÃµ Tuáº¥n Minh|19521858@gm.uit.edu.vn|

[0]:https://github.com/danhhuynh25029
[2]:https://github.com/minh1304
[1]:https://github.com/phuvinh010701
[3]:https://www.facebook.com/danh250/
[4]:https://www.facebook.com/phuvinh0107
[5]:https://www.facebook.com/tuanminh.vo.73

## Báº£ng má»¥c lá»¥c
ChÆ°Æ¡ng 1.[Tá»•ng quan](#giá»›i-thiá»‡u-bÃ i-toÃ¡n:)

ChÆ°Æ¡ng 2.[CÃ¡c nghiÃªn cá»©u trÆ°á»›c](#xÃ¢y-dá»±ng-bá»™-dá»¯-liá»‡u:)

ChÆ°Æ¡ng 3.[XÃ¢y dá»±ng bá»™ dá»¯ liá»‡u](#mÃ´-hÃ¬nh-sá»­-dá»¥ng:)

ChÆ°Æ¡ng 4.[Training vÃ  Ä‘Ã¡nh giÃ¡ model](#phÆ°Æ¡ng-phÃ¡p-Ä‘Ã¡nh-giÃ¡:)

ChÆ°Æ¡ng 5.[á»¨ng dá»¥ng vÃ  hÆ°á»›ng phÃ¡t triá»ƒn](#Ä‘Ã¡nh-giÃ¡-káº¿t-quáº£:)

# ChÆ°Æ¡ng 1. Tá»”NG QUAN

## 1.1 MÃ´ táº£ bÃ i toÃ¡n

* Ngá»¯ cáº£nh á»©ng dá»¥ng : 
    
    * Hiá»‡n nay, cÃ  phÃª lÃ  má»™t trong nhá»¯ng loáº¡i thá»©c uá»‘ng Ä‘Æ°á»£c sá»­ dá»¥ng phá»• biáº¿n láº«n trong vÃ  ngoÃ i nÆ°á»›c. CÃ  phÃª Ä‘Æ°á»£c sáº£n xuáº¥t tá»« nhá»¯ng háº¡t cÃ  phÃª rang, láº¥y trÃªn cÃ¢y cÃ  phÃª.

    <p align="center">
    <img src="images/caphe.jpg" style="display: block;margin-left: auto;margin-right: auto;width: 50%;"/>
    <br>
    <a style="text-align: center">HÃ¬nh 1. áº¢nh minh há»a (Nguá»“n: Internet).</a>
    </p>

    * Theo bÃ¡o Ä‘iá»‡n tá»­ VTV, trÃªn 90% tá»•ng sáº£n lÆ°á»£ng cÃ  phÃª cá»§a Viá»‡t Nam dÃ nh cho viá»‡c xuáº¥t kháº©u, khoáº£ng 10% cÃ²n láº¡i lÃ  dÃ nh cho viá»‡c cháº¿ biáº¿n vÃ  tiÃªu thá»¥ trong nÆ°á»›c. CÃ  phÃª náº±m trong nhÃ³m hÃ ng nÃ´ng sáº£n xuáº¥t kháº©u chá»§ lá»±c cá»§a Viá»‡t Nam, hiá»‡n Ä‘á»©ng thá»© 2 tháº¿ giá»›i (chá»‰ sau Brazil). TÃ­nh chung cáº£ nÄƒm 2021, xuáº¥t kháº©u cÃ  phÃª cá»§a Viá»‡t Nam Ä‘áº¡t 1,52 triá»‡u táº¥n.

    <p align="center">
    <img src="images/bieudoxuatkhau.jpg" style="display: block;margin-left: auto;margin-right: auto;width: 50%;"/>
    <br>
    <a style="text-align: center">HÃ¬nh 2. LÆ°á»£ng cÃ  phÃª xuáº¥t kháº©u qua cÃ¡c thÃ¡ng giai Ä‘oáº¡n tá»« 2019-2021.</a>
    </p>

    * Sáº£n lÆ°á»£ng tuy lá»›n nhÆ°ng cÃ  phÃª váº«n chÆ°a Ä‘Ã¡p á»©ng Ä‘Æ°á»£c cÃ¡c tiÃªu chuáº©n vá» cháº¥t lÆ°á»£ng. Nháº±m nÃ¢ng cao cháº¥t lÆ°á»£ng cá»§a háº¡t cÃ  phÃª, viá»‡c phÃ¡t hiá»‡n vÃ  xá»­ lÃ½ nhá»¯ng cÄƒn bá»‡nh trÃªn lÃ¡ cá»§a cÃ¢y ráº¥t quan trá»ng. Nháº­n tháº¥y Ä‘Æ°á»£c váº¥n Ä‘á» Ä‘Ã³ nÃªn nhÃ³m Ä‘Ã£ quyáº¿t Ä‘á»‹nh Ã¡p dá»¥ng nhá»¯ng kiáº¿n thá»©c cá»§a mÃ¬nh vÃ  nhá»¯ng cÃ´ng nghá»‡ trong lÄ©nh vá»±c Machine Learning Ä‘á»ƒ giáº£i quyáº¿t bÃ i toÃ¡n phÃ¡t hiá»‡n má»™t sá»‘ loáº¡i bá»‡nh trÃªn lÃ¡ cÃ¢y cÃ  phÃª.

    * MÃ´ hÃ¬nh hÆ°á»›ng tá»›i ngÆ°á»i sá»­ dá»¥ng lÃ  ngÆ°á»i trá»“ng cÃ¢y cÃ  phÃª, xÃ¢y dá»±ng má»™t á»©ng dá»¥ng cÃ³ thá»ƒ giÃºp ngÆ°á»i trá»“ng cÃ³ thá»ƒ phÃ¡t hiá»‡n chÃ­nh xÃ¡c hÆ¡n cÃ¡c loáº¡i bá»‡nh Ä‘ang gáº·p trÃªn lÃ¡ cá»§a cÃ¢y vÃ  Ä‘Æ°a ra Ä‘Æ°á»£c giáº£i phÃ¡p phÃ¹ há»£p nháº±m loáº¡i bá» bá»‡nh vÃ  tÃ¡c nhÃ¢n gÃ¢y bá»‡nh. 
    
* Input vÃ  Output:
    
    * Input:
        
        * Má»™t táº¥m áº£nh chá»¥p hÃ¬nh lÃ¡ cá»§a cÃ¢y cÃ  phÃª Ä‘ang bá»‹ bá»‡nh.

        <p align="center">
        <img src="images/viduinput.JPG" style="display: block;margin-left: auto;margin-right: auto;width: 50%; height:50%;"/>
        <br>
        <a style="text-align: center">HÃ¬nh 3. VÃ­ dá»¥ vá» áº£nh input thÃ­ch há»£p.</a>
        </p>

        * CÃ¡c Ä‘iá»u kiá»‡n rÃ ng buá»™c :
            + áº¢nh chá»¥p táº­p trung vÃ o lÃ¡ Ä‘ang bá»‹ bá»‡nh
            + Chá»¥p Ä‘Æ°á»£c tá»« cuá»‘n lÃ¡ Ä‘áº¿n chÃ³p lÃ¡
            + Chá»¥p trong Ä‘iá»u kiá»‡n Ã¡nh sÃ¡ng ban ngÃ y
            
    * Output:

        * Bounding box bao quanh lÃ¡ cÃ¢y bá»‹ bá»‡nh
        * TÃªn loáº¡i bá»‡nh
    <br>
    ğŸ Š Trong á»©ng dá»¥ng thá»±c táº¿ hoÃ n chá»‰nh, dá»±a vÃ o tÃªn loáº¡i bá»‡nh xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c á»©ng dá»¥ng sáº½ Ä‘Æ°a ra cÃ¡c giáº£i phÃ¡p phÃ¹ há»£p cho ngÆ°á»i trá»“ng

## 1.2 MÃ´ táº£ dá»¯ liá»‡u
* Dá»¯ liá»‡u cá»§a bÃ i toÃ¡n Ä‘Æ°Æ¡c nhÃ³m tá»± thu tháº­p tá»« má»‘t sá»‘ vÆ°á»n chuyÃªn trá»“ng cÃ  phÃª trÃªn Ä‘á»‹a bÃ n huyá»‡n Láº¡c DÆ°Æ¡ng vÃ  Ä‘á»‹a bÃ n thÃ nh phá»‘ ÄÃ  Láº¡t thuá»™c tá»‰nh LÃ¢m Äá»“ng. Trong quÃ¡ trÃ¬nh thu tháº­p dá»¯ liá»‡u, nhÃ³m gáº·p nhiá»u khÃ³ khÄƒn nhÆ° viá»‡c di chuyá»ƒn Ä‘áº¿n cÃ¡c vÆ°á»n cÃ  phÃª khÃ¡ xa so vá»›i nhÃ  riÃªng (khoáº£ng hÆ¡n 20 km), dá»‹ch bá»‡nh COVID-19 khiáº¿n cho viá»‡c Ä‘i qua cÃ¡c chá»‘t phong tá»a khÃ³ khÄƒn.
    <p align="center">
    <img src="images/vuoncaphetramhanh.jpg" style="display: block;margin-left: auto;margin-right: auto;width: 50%; height:50%;"/>
    <br>
    <a style="text-align: center">HÃ¬nh 4. VÆ°á»n cÃ  phÃª thuá»™c xÃ£ Tráº¡m HÃ nh, thÃ nh phá»‘ ÄÃ  Láº¡t, tá»‰nh LÃ¢m Äá»“ng.</a>
    </p>
* Bá»™ dá»¯ liá»‡u vá» lÃ¡ cÃ¢y cÃ  phÃª hiá»‡n nay chÆ°a cÃ³ ai thu tháº­p nÃªn sá»‘ lÆ°á»£ng dá»¯ liá»‡u mÃ  nhÃ³m cÃ³ váº«n cÃ²n háº¡n cháº¿ do dá»¯ liá»‡u tá»± thu tháº­p vÃ  xá»­ lÃ½. Má»¥c Ä‘Ã­ch cá»§a viá»‡c tá»± thu tháº­p dá»¯ liá»‡u lÃ  Ä‘á»ƒ phÃ¹ há»£p vá»›i ngá»¯ cáº£nh á»©ng dá»¥ng cá»§a bÃ i toÃ¡n.

# ChÆ°Æ¡ng 2. CÃC NGHIÃŠN Cá»¨U TRÆ¯á»šC
* BÃ i toÃ¡n cá»§a nhÃ³m Ä‘áº·t ra lÃ  muá»‘n hÆ°á»›ng Ä‘áº¿n bÃ i toÃ¡n thuá»™c loáº¡i Object Detection (PhÃ¡t hiá»‡n Ä‘á»‘i tÆ°á»£ng), Ä‘á»‹nh vá»‹ Ä‘á»‘i tÆ°á»£ng trong áº£nh vÃ  xÃ¡c Ä‘á»‹nh Ä‘á»‘i tÆ°á»£ng thuá»™c loáº¡i nÃ o. Trong lÄ©nh vá»±c thá»‹ giÃ¡c mÃ¡y tÃ­nh thÃ¬ bÃ i toÃ n phÃ¡t hiá»‡n Ä‘á»‘i tÆ°á»£ng Ä‘áº¡t Ä‘Æ°á»£c nhiá»u káº¿t quáº£ khi Ã¡p dá»¥ng hÆ°á»›ng tiáº¿p cáº­n Deep learning. CÃ³ thá»ƒ ká»ƒ Ä‘áº¿n má»™t sá»‘ hÆ°á»›ng tiáº¿p cáº­n tiÃªn tiáº¿n hiá»‡n nay bao gá»“m RCNN, Fast RCNN, Faster RCNN, Mask RCNN, RetinaNet, YOLO, v.v
* Faster RCNN
    * PhÆ°Æ¡ng phÃ¡p Faster RCNN lÃ  má»™t trong cÃ¡c phÆ°Æ¡ng phÃ¡p phÃ¡t hiá»‡n Ä‘á»‘i tÆ£á»£ng sá»­ dá»¥ng máº¡ng Deep learning Ä‘áº¡t Ä‘á»™ chÃ­nh xÃ¡c cao trÃªn cÃ¡c táº­p dá»¯ liá»‡u chuáº©n nhÆ° COCO . Faster RCNN Ä‘Æ°á»£c cáº£i tiáº¿n dá»±a trÃªn 2 phÆ°Æ¡ng phÃ¡p trÆ°á»›cc Ä‘Ã³ lÃ  RCNN vÃ  Fast RCNN.
* Mask RCNN
    * PhÆ°Æ¡ng phÃ¡p Mask RCNN lÃ  phÆ°Æ¡ng phÃ¡p thá»±c hiá»‡n song song 2 bÃ i toÃ¡n lÃ  phÃ¢n vÃ¹ng Ä‘á»‘i tÆ°á»£ng (Instance Segmentation) vÃ  phÃ¡t hiá»‡n Ä‘á»‘i tÆ°á»£ng. Mask RCNN lÃ  phÆ°Æ¡ng phÃ¡p Ä‘Æ°á»£c cáº£i tiáº¿n tá»« Faster RCNN.
* Restinanet
    * RetinaNet lÃ  má»™t phÆ£Æ¡ng phÃ¡p tiáº¿p cáº­n one-stage tá»©c lÃ  ngay trong báº£n thÃ¢n cáº¥u trÃºc máº¡ng cá»§a phÆ£Æ¡ng phÃ¡p Ä‘Ã£ bao gá»“m thao tÃ¡c Ä‘Æ°a ra vÃ¹ng Ä‘á» xuáº¥t
* YOLO
    * YOLO Ä‘Æ°á»£c xem lÃ  phÆ°Æ¡ng phÃ¡p Ä‘áº§u tiÃªn xá»­ lÃ½ dá»¯ liá»‡u theo thá»i gian thá»±c vÃ  váº«n Ä‘áº¡t Ä‘Æ°á»£c Ä‘á»™ chÃ­nh xÃ¡c cao.
* Má»™t sá»‘ káº¿t quáº£ nghiÃªn cá»©u Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ trÃªn táº­p COCO. COCO (Common Objects in Context) lÃ  má»™t táº­p datasets phá»¥c vá»¥ cho cÃ¡c bÃ i toÃ¡n Object Detection, Segmentation, Image Captioning. Táº­p dá»¯ liá»‡u tá»•ng cá»™ng cÃ³ khoáº£ng 1.5 triá»‡u object thuá»™c vá» 80 class khÃ¡c nhau.
    <p align="center">
    <img src="images/perfomance_of_coco.png" style="display: block;margin-left: auto;margin-right: auto;width: 50%; height:50%;"/>
    <br>
    <a style="text-align: center">HÃ¬nh 5. Perfomance trÃªn táº­p COCO.</a>
    </p>
# ChÆ°Æ¡ng 3. XÃ‚Y Dá»°NG Bá»˜ Dá»® LIá»†U
* ### QuÃ¡ trÃ¬nh thu tháº­p:
    * Dá»¯ liá»‡u Ä‘Æ°á»£c nhÃ³m thu tháº­p thá»§ cÃ´ng báº±ng camera cá»§a Ä‘iá»‡n thoáº¡i.
    * Äiá»‡n thoáº¡i sá»­ dá»¥ng: Iphone 7 Plus, 32GB.
    * Má»—i táº¥m áº£nh gá»‘c cÃ³ kÃ­ch thÆ°á»›c 3024 x 4032 (camera náº±m ngang), 4032 x 3024 (camera náº±m dá»c)

        <p align="center">
        <img src="images/details_image.png" style="display: block;margin-left: auto;margin-right: auto;width: 50%; height:50%;"/>
        <br>
        <a style="text-align: center">HÃ¬nh 6. Äá»™ phÃ¢n giáº£i vÃ  camera sá»­ dá»¥ng.</a>
        </p>

    * File áº£nh Ä‘Æ°á»£c lÆ°u trá»¯ trong cÃ¹ng 1 folder trÃªn mÃ¡y tÃ­nh dÆ°á»›i dáº¡ng tá»‡p .JPG

    * Thá»i gian thu tháº­p dá»¯ liá»‡u:

<center>

| STT | Thá»i gian thu tháº­p | Äá»‹a Ä‘iá»ƒm thu tháº­p |
| :---: | --- | --- |
| 1 | 20/12/2021 | Huyá»‡n Láº¡c DÆ°Æ¡ng |
| 2 | 25/12/2021 | XÃ£ Tráº¡m HÃ nh |
| 3 | 1/2/2022 | XÃ£ Tráº¡m HÃ nh |
</center>


* ### TiÃªu chÃ­ khi thu tháº­p dá»¯ liá»‡u :

    * Chá»¥p rÃµ nÃ©t táº­p trung vÃ o lÃ¡ cÃ¢y bá»‹ bá»‡nh.
    * Chá»¥p toÃ n bá»™ chiáº¿c lÃ¡ tá»« pháº§n cuá»‘n lÃ¡ Ä‘áº¿n chÃ³p lÃ¡.
    * Äáº£m báº£o Ã¡nh sÃ¡ng ban ngÃ y.
    
* ### Giáº£m Ä‘á»™ phÃ¢n giáº£i cá»§a áº£nh :

    * Do má»—i áº£nh cÃ³ kÃ­ch thÆ°á»›c khÃ¡ lá»›n nÃªn dung lÆ°á»£ng lÆ°u trá»¯ khÃ¡ náº·ng. Äá»‘i vá»›i folder chá»©a toÃ n bá»™ dá»¯ liá»‡u gá»‘c náº·ng khoáº£ng 11.2 Gb gÃ¢y khÃ³ khÄƒn trong viá»‡c lÆ°u trá»¯ náº¿n nhÃ³m Ä‘Ã£ giáº£m Ä‘á»™ phÃ¢n giáº£i xuá»‘ng ~ 3.33 láº§n. Äá»™ phÃ¢n giáº£i sau khi giáº£m 907 x 1209 vÃ  1209 x 907. Dung lÆ°á»£ng lÆ°u trá»¯ sau khi xá»­ lÃ½ náº·ng khoáº£ng 1.6 Gb.


* ### GÃ¡n nhÃ£n dá»¯ liá»‡u :

    * Sá»­ dá»¥ng cÃ´ng cá»¥ labelImg Ä‘á»ƒ tiáº¿n hÃ nh gÃ¡n nhÃ£n toÃ n bá»™ dá»¯ liá»‡u
        <p align="center">
        <img src="images/label.png" style="display: block;margin-left: auto;margin-right: auto;width: 50%; height:50%;"/>
        <br>
        <a style="text-align: center">HÃ¬nh 7. CÃ´ng cá»¥ labelImg.</a>
        </p>

    * Sá»­ dá»¥ng thao tÃ¡c kÃ©o tháº£ chuá»™t Ä‘á»ƒ táº¡o bouding box cho Ä‘á»‘i tÆ°á»£ng. Label Ä‘Æ°á»£c lÆ°u thÃ nh file text cÃ³ cÃ¹ng tÃªn vá»›i áº£nh dÆ°á»›i dáº¡ng YOLO format.
            <p align="center">
            <img src="images/yoloformat.jpg" style="display: block;margin-left: auto;margin-right: auto;width: 50%; height:50%;"/>
            <br>
            <a style="text-align: center">HÃ¬nh 8. áº¢nh, label vÃ  label format cá»§a YOLO.</a>
            </p>

    * Trong má»™t áº£nh cÃ³ thá»ƒ cÃ³ nhiá»u lÃ¡ nhá»¯ng chá»‰ label nhá»¯ng lÃ¡ bá»‹ bá»‡nh vÃ  tháº¥y rÃµ tá»« cuá»‘n lÃ¡ Ä‘áº¿n chÃ³p lÃ¡.

    * Sá»‘ loáº¡i label lÃ  4. ÄÆ°á»£c kÃ­ hiá»‡u báº±ng 1 trong cÃ¡c chá»¯ sá»‘ 0, 1, 2, 3

    ***Label 0: Bá»‡nh sÃ¢u váº½ bÃ¹a***
    
    * Nhá»¯ng lÃ¡ bá»‹ sÃ¢u váº½ bÃ¹a gÃ¢y háº¡i sáº½ bá»‹ co láº¡i, biáº¿n dáº¡ng. SÃ¢u non chui qua lá»›p biá»ƒu bÃ¬ cá»§a lÃ¡ Ä‘á»ƒ Äƒn pháº§n nhu mÃ´ cá»§a lÃ¡ táº¡o thÃ nh Ä‘Æ°á»ng háº§m ngoáº±n ngoÃ¨o mÃ u tráº¯ng, tráº¯ng Ä‘á»¥c dÆ°á»›i lá»›p biá»ƒu bÃ¬.
        
    <p align="center">
    <img src="images/vidusauvebua.jpg" style="display: block;margin-left: auto;margin-right: auto;width: 50%; height:50%;"/>
    <br>
    <a style="text-align: center">HÃ¬nh 9. Má»™t sá»‘ vÃ­ dá»¥ vá» bá»‡nh sÃ¢u váº½ bÃ¹a trÃªn lÃ¡ cÃ  phÃª.</a>
    </p>

    ***Label 1: Bá»‡nh pháº¥n tráº¯ng***
    
    * Bá»‡nh pháº¥n tráº¯ng do má»™t sá»‘ loáº¡i náº¥m cÃ³ há» hÃ ng gáº§n gÃ¢y ra. Triá»‡u chá»©ng chung lÃ  chÃºng táº¡o ra lá»›p bá»™t cÃ³ mÃ u tráº¯ng xÃ¡m trÃªn bá» máº·t cá»§a lÃ¡.
        
    <p align="center">
    <img src="images/viduphantrang.jpg" style="display: block;margin-left: auto;margin-right: auto;width: 50%; height:50%;"/>
    <br>
    <a style="text-align: center">HÃ¬nh 10. Má»™t sá»‘ vÃ­ dá»¥ vá» bá»‡nh pháº¥n tráº¯ng trÃªn lÃ¡ cÃ  phÃª.</a>
    </p>

    ***Label 2: Bá»‡nh náº¥m rá»‰ sáº¯t***
    
    * TrÃªn lÃ¡ xuáº¥t hiá»‡n cÃ¡c váº¿t Ä‘á»‘m hÃ¬nh trÃ²n mÃ u nÃ¢u cam hÆ¡i Ä‘á» (giá»‘ng rá»‰ sáº¯t), xung quanh cÃ³ váº§ng mÃ u vÃ ng Ãºa.
        
    <p align="center">
    <img src="images/vidurisat.jpg" style="display: block;margin-left: auto;margin-right: auto;width: 50%; height:50%;"/>
    <br>
    <a style="text-align: center">HÃ¬nh 11. Má»™t sá»‘ vÃ­ dá»¥ vá» bá»‡nh náº¥m rá»‰ sáº¯t trÃªn lÃ¡ cÃ  phÃª.</a>
    </p>

    ***Label 3: Bá»‡nh Ä‘á»‘m rong***
    
    *  Äá»‘m bá»‡nh cÃ³ hÃ¬nh trÃ²n lÃºc Ä‘áº§u nhá» khoáº£ng 3 - 5 mm, hÆ¡i nhÃ´ lÃªn trÃªn máº·t lÃ¡ do rong phÃ¡t triá»ƒn thÃ nh ung má»‹n, mÃ u hÆ¡i vÃ ng.
        
    <p align="center">
    <img src="images/vidudomrong.jpg" style="display: block;margin-left: auto;margin-right: auto;width: 50%; height:50%;"/>
    <br>
    <a style="text-align: center">HÃ¬nh 12. Má»™t sá»‘ vÃ­ dá»¥ vá» bá»‡nh Ä‘á»‘m rong trÃªn lÃ¡ cÃ  phÃª.</a>
    </p>

* ### Thá»‘ng sá»‘ bá»™ dá»¯ liá»‡u :
    * Tá»•ng sá»‘ lÆ°á»£ng áº£nh trong bá»™ dá»¯ liá»‡u lÃ  3825 áº£nh
    * Tá»•ng sá»‘ object lÃ  4092

    <p align="center">
    <img src="images/Figure_1.png" style="display: block;margin-left: auto;margin-right: auto;width: 50%; height:50%;"/>
    <br>
    <a style="text-align: center">HÃ¬nh 13. Sá»‘ lÆ°á»£ng object thuá»™c tá»«ng loáº¡i label.</a>
    </p>

    
    **Nháº­n xÃ©t :** Sá»‘ lÆ°á»£ng label thuá»™c bá»‡nh pháº¥n tráº¯ng khÃ¡ Ã­t so vá»›i cÃ¡c bá»‡nh khÃ¡c, nguyÃªn nhÃ¢n lÃ  bá»‡nh nÃ y xuáº¥t hiá»‡n khÃ¡ Ã­t táº¡i cÃ¡c vÆ°á»n cÃ  phÃª thu tháº­p dá»¯ liá»‡u.

    * Táº­p dá»¯ liá»‡u Ä‘Æ°á»£c chia thÃ nh hai táº­p train vÃ  test vá»›i tá»‰ lá»‡ lÃ  80% cho táº­p train vÃ  20% cho táº­p test
    <p align="center">
    <img src="images/train.png" style="display: block;margin-left: auto;margin-right: auto;"/>
    <br>
    <a style="text-align: center">HÃ¬nh 14. Sá»‘ lÆ°á»£ng object thuá»™c tá»«ng loáº¡i label trong táº­p train.</a>
    </p>
    <p align="center">
    <img src="images/test.png" style="display: block;margin-left: auto;margin-right: auto;"/>
    <br>
    <a style="text-align: center">HÃ¬nh 15. Sá»‘ lÆ°á»£ng object thuá»™c tá»«ng loáº¡i label trong táº­p test.</a>
    </p>

    Trong Ä‘Ã³: <br>
        0 : SÃ¢u váº½ bÃ¹a <br>
        1 : Pháº¥n tráº¯ng <br>
        2 : Náº¥m rá»‰ sáº¯t <br>
        3 : Äá»‘m rong <br>
# ChÆ°Æ¡ng 4. TRAINING VÃ€ ÄÃNH GIÃ MODEL
## Cáº¥u hÃ¬nh train vÃ  test:
<p align="center">
<img src="images/cauhinhtrain.jpg" style="display: block;margin-left: auto;margin-right: auto;width: 50%"/>
<br>
<a style="text-align: center">HÃ¬nh 16. Cáº¥u hÃ¬nh dÃ¹ng Ä‘á»ƒ train vÃ  test.</a>
</p>

## YOLOv4:
<p align="center">
<img src="images/yolov4_archi.png" style="display: block;margin-left: auto;margin-right: auto; width: 75%"/>
<br>
<a style="text-align: center">HÃ¬nh 16. Cáº¥u trÃºc mÃ´ hÃ¬nh YOLOv4.</a>
</p>

### SÆ¡ lÆ°á»£c vá» YOLOv4

* YOLOv4 lÃ  má»™t loáº¡t cÃ¡c cáº£i tiáº¿n vá» tá»‘c Ä‘á»™ so vá»›i YOLOv3 vÃ  Ä‘Æ°á»£c cÃ i Ä‘áº·t tá»« má»™t báº£n fork cá»§a Darknet. Kiáº¿n trÃºc cá»§a YOLOv4 Ä‘Ã£ Ä‘Æ°a bÃ i toÃ¡n object detection dá»… tiáº¿p cáº­n hÆ¡n vá»›i nhá»¯ng ngÆ°á»i khÃ´ng cÃ³ tÃ i nguyÃªn tÃ­nh toÃ¡n máº¡nh.

<p align="center">
<img src="images/yolov4_compare.jpeg" style="display: block;margin-left: auto;margin-right: auto; width: 75%"/>
<br>
<a style="text-align: center">HÃ¬nh 17. So sÃ¡nh YOLOv4 vá»›i cÃ¡c mÃ´ hÃ¬nh khÃ¡c.</a>
</p>

* Káº¿t quáº£ so sÃ¡nh YOLOv4 vá»›i cÃ¡c mÃ´ hÃ¬nh khÃ¡c á»Ÿ thá»i Ä‘iá»ƒm hiá»‡n táº¡i. YOLOv4 cháº¡y nhanh gáº¥p Ä‘Ã´i EfficientDet vÃ  tÄƒng AP vÃ  FPS so vá»›i YOLOv3 láº§n lÆ°á»£t lÃ  10% vÃ  12%. HÃ¬nh áº£nh tá»« paper YOLOv4. NhÃ¬n vÃ o biá»ƒu Ä‘á»“, ta dá»… dÃ ng tháº¥y Ä‘Æ°á»£c sá»± hiá»‡u quáº£ cá»§a YOLOv4 so vá»›i cÃ¡c máº¡ng tá»‘t nháº¥t hiá»‡n nay. Cá»¥ thá»ƒ hÆ¡n YOLOv4 Ä‘áº¡t 43.5% AP trÃªn táº­p dá»¯ liá»‡u MS COCO á»Ÿ tá»‘c Ä‘á»™ 65 FPS, trÃªn GPU Tesla V100. 

### Thiáº¿t láº­p training

* Äá»ƒ train model nhÃ³m sá»­ dá»¥ng tÃ i nguyÃªn cá»§a Google Colab vá»›i thiáº¿t láº­p runtime type lÃ  GPU

<p align="center">
<img src="images/runtime.png" style="display: block;margin-left: auto;margin-right: auto; width: 30%; height:30%"/>
<br>
<a style="text-align: center">HÃ¬nh 18. Báº­t GPU trÃªn Google Colab.</a>
</p>

* NhÃ³m sá»­ dá»¥ng darknet repository cá»§a tÃ¡c giáº£ Ä‘á»ƒ huáº¥n luyá»‡n cho model vÃ  thiáº¿t láº­p cÃ¡c thÃ´ng sá»‘ trong file Makefile nhÆ° sau
<p align="center">
<img src="images/configmakefile.png" style="display: block;margin-left: auto;margin-right: auto; width: 20%; height:20%;"/>
<br>
<a style="text-align: center">HÃ¬nh 19. Thiáº¿t láº­p cÃ¡c thÃ´ng sá»‘ Makefile Ä‘á»ƒ sá»­ dá»¥ng GPU.</a>
</p>

* Chá»‰nh sá»­a cÃ¡c thÃ´ng sá»‘ cá»§a model YOLOv4 trong file yolov4-custom.cfg theo hÆ°á»›ng dáº«n cá»§a tÃ¡c giáº£:
    * batch: 32
    * subdivisions = 32
    * max_batches = 8000 (Báº±ng sá»‘ class * 2000)
    * steps = 6400, 7200 (Báº±ng 0.8 * max_batches, 0.9 * max_batches)
    * width = 416, height = 416 (KÃ­ch thÆ°á»›c cá»§a áº£nh)
    * classes = 4 (Sá»‘ class)
    * filters = 27 (TÃ­nh theo cÃ´ng thá»©c filters = (classes + 5) * 3) 

* Táº¡o file train.txt chá»©a Ä‘Æ°á»ng dáº«n tá»›i cÃ¡c áº£nh dÃ¹ng Ä‘á»ƒ train (3138 áº£nh)
<p align="center">
<img src="images/path_train.png" style="display: block;margin-left: auto;margin-right: auto; width: 20%; height:20%;"/>
<br>
<a style="text-align: center">HÃ¬nh 20. File train.txt</a>
</p>


* Táº¡o file valid.txt chá»©a Ä‘Æ°á»ng dáº«n tá»›i cÃ¡c áº£nh dÃ¹ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ trong quÃ¡ trÃ¬nh train (687 áº£nh)
<p align="center">
<img src="images/path_valid.png" style="display: block;margin-left: auto;margin-right: auto; width: 20%; height:20%;"/>
<br>
<a style="text-align: center">HÃ¬nh 21. File valid.txt</a>
</p>

* Táº¡o file obj.names chá»©a tÃªn cá»§a cÃ¡c class
<p align="center">
<img src="images/obj.png" style="display: block;margin-left: auto;margin-right: auto; width: 20%; height:20%;"/>
<br>
<a style="text-align: center">HÃ¬nh 22. File obj.names</a>
</p>

* Táº¡o file obj.data cÃ³ ná»™i dung nhÆ° sau
<p align="center">
<img src="images/obj_data.png" style="display: block;margin-left: auto;margin-right: auto; width: 20%; height:20%;"/>
<br>
<a style="text-align: center">HÃ¬nh 23. File obj.data</a>
</p>

    Trong Ä‘Ã³:
    classes: lÃ  sá»‘ lÆ°á»£ng class
    train: Ä‘Æ°á»ng dáº«n tá»›i file train.txt
    valid: Ä‘Æ°á»ng dáº«n tá»›i file valid.txt
    names: Ä‘Æ°á»ng dáº«n tá»›i file obj.names
    backup: Ä‘Æ°á»ng dáº«n tá»›i folder backup chá»©a cÃ¡c trá»ng sá»‘ Ä‘Æ°á»£c lÆ°u láº¡i trong quÃ¡ trÃ¬nh train

### Train model
* Táº£i file trá»ng sá»‘ yolov4.conv.137.weights vÃ  tiáº¿n hÃ nh train trÃªn file trá»ng sá»‘ nÃ y
* Trong quÃ¡ trÃ¬nh train model cÃ¡c file trá»ng sá»‘ Ä‘Æ°á»£c lÆ°u láº¡i tronng Ä‘Ã³ cÃ³ 2 file quan trá»ng lÃ :
    * yolov4-custom_last.weights (Trá»ng sá»‘ cá»§a interation má»›i nháº¥t)
    * yolov4-custom_best.weights (Trá»ng sá»‘ tá»‘t nháº¥t)
* QuÃ¡ trÃ¬nh training khÃ¡ lÃ¢u vÆ°á»£t qua thá»i gian cho phÃ©p cá»§a Google Colab nÃªn á»Ÿ nhá»¯ng láº§n train tiáº¿p theo nhÃ³m tiáº¿n hÃ nh train tiáº¿p trÃªn file trá»ng sá»‘ má»›i nháº¥t
* Thá»i gian train model: khoáº£ng 28 tiáº¿ng
* Thá»i gian test trÃªn 686 áº£nh: 53 giÃ¢y 

## YOLOv5:

### SÆ¡ lÆ°á»£c vá» YOLOv5
* KhÃ´ng lÃ¢u sau khi YOLOv4 Ä‘Æ°á»£c phÃ¡t hÃ nh chÃ­nh thá»©c thÃ¬ 1 phiÃªn báº£n khÃ¡c cá»§a YOLO xuáº¥t hiá»‡n lÃ  YOLOv5 sá»­ dá»¥ng frame work Pytorch. Vá»›i nhá»¯ng sá»‘ liá»‡u cá»§a tÃ¡c giáº£ cung cáº¥p thÃ¬ mÃ´ hÃ¬nh nÃ y khÃ¡ triá»ƒn vá»ng. Tuy nhiÃªn YOLOv4 hiá»‡n váº«n chÆ°a cÃ³ paper chÃ­nh thá»©c.

<p align="center">
<img src="images/yolov5_coco.png" style="display: block;margin-left: auto;margin-right: auto; width: 75%"/>
<br>
<a style="text-align: center">HÃ¬nh 24. Perfomance cá»§a cÃ¡c phiÃªn báº£n YOLOv5 trÃªn táº­p COCO</a>
</p>

<p align="center">
<img src="images/pre_check.png" style="display: block;margin-left: auto;margin-right: auto; width: 75%"/>
<br>
<a style="text-align: center">HÃ¬nh 25. Káº¿t quáº£ Ä‘Ã¡nh giÃ¡ trÃªn táº­p COCO</a>
</p>

* Tá»« nhá»¯ng káº¿t quáº£ mÃ  tÃ¡c giáº£ Ä‘Æ°a ra cÃ³ thá»ƒ tháº¥y YOLOv5 cÃ³ thá»ƒ Ä‘áº¡t tá»›i 68.9% mAP0.5 trÃªn táº­p COCO.

### Thiáº¿t láº­p training
* Táº¡o file data.yaml cÃ³ ná»™i dung nhÆ° sau
<p align="center">
<img src="images/data_yaml.png" style="display: block;margin-left: auto;margin-right: auto; width: 20%; height:20%;"/>
<br>
<a style="text-align: center">HÃ¬nh 26. File data.yaml</a>
</p>

    Trong Ä‘Ã³:
    names: láº§n lÆ°á»£t lÃ  tÃªn cá»§a cÃ¡c label Ä‘Æ°á»£c Ä‘áº·t trong dáº¥u ngoáº·c kÃ©p
    nc: sá»‘ lÆ°á»£ng class
    train: Ä‘Æ°á»ng dáº«n tá»›i cÃ¡c file áº£nh train
    valid: Ä‘Æ°á»ng dáº«n tá»›i cÃ¡c file áº£nh dÃ¹ng Ä‘á»ƒ valid trong quÃ¡ trÃ¬nh train

* Thiáº¿t láº­p training
    * batch: 32
    * img size: 416
    * epoch: 500

### Train model
* Táº£i file trá»ng sá»‘ cá»§a model YOLOv5s vÃ  tiáº¿n hÃ nh train trÃªn file trá»ng sá»‘ nÃ y.
* Trong quÃ¡ trÃ¬nh train model cÃ¡c file trá»ng sá»‘ Ä‘Æ°á»£c lÆ°u láº¡i tronng Ä‘Ã³ cÃ³ 2 file quan trá»ng lÃ :
    * last.pt (Trá»ng sá»‘ cá»§a epoch má»›i nháº¥t)
    * best.pt (Trá»ng sá»‘ tá»‘t nháº¥t)
* QuÃ¡ trÃ¬nh training khÃ¡ lÃ¢u vÆ°á»£t qua thá»i gian cho phÃ©p cá»§a Google Colab nÃªn á»Ÿ nhá»¯ng láº§n train tiáº¿p theo nhÃ³m tiáº¿n hÃ nh train tiáº¿p trÃªn file trá»ng sá»‘ má»›i nháº¥t
* VÃ o epoch 450 thÃ¬ xuáº¥t hiá»‡n thÃ´ng bÃ¡o dá»«ng train model nhÆ° sau:
<p align="center">
<img src="images/stopping.jpg" style="display: block;margin-left: auto;margin-right: auto; width: 100%;"/>
<br>
<a style="text-align: center">HÃ¬nh 27. Early stopping YOLOv5</a>
</p>

* Do trong 100 epoch gáº§n nháº¥t thÃ¬ model khÃ´ng cÃ²n tá»‘t lÃªn Ä‘Æ°á»£c ná»¯a (model há»™i tá»¥) nÃªn tá»± Ä‘á»™ng dá»«ng train.
* Thá»i gian train model: khoáº£ng 8 tiáº¿ng
* Thá»i gian test trÃªn 686 áº£nh: 32 giÃ¢y

## Faster-RCNN:


## ÄÃ¡nh giÃ¡ model

* Thiáº¿t láº­p cÃ¡c ngÆ°á»¡ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡
    * confidence thresh: 0.25
    * iou thresh: 0.5

| Model | Precision | Recall | mAP0.5 |
| :---: | --- | --- | --- |
| YOLOv4 | 0.90 | 0.98 | 0.989 |
| YOLOv5s | 0.988 | 0.99 | 0.995 |
## ChÆ°á»›ng 5. á»¨ng dá»¥ng vÃ  hÆ°á»›ng phÃ¡t triá»ƒn:

## TÃ i liá»‡u tham kháº£o:
Danh & Vinh
